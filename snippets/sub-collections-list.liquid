{%- liquid
  assign column = columns_desktop
  assign class_item = ''
  case column
    when 6
      assign column_xxl = '6'
      assign column_xl = '5'
      assign column_lg = '4'
      assign column_md = '3'
      assign column_sm = '2'
      assign class_item = 'grid__item--xl grid__item--xxl'
    when 5
      assign column_xxl = '5'
      assign column_xl = '5'
      assign column_lg = '4'
      assign column_md = '3'
      assign column_sm = '2'
      assign class_item = 'grid__item--xl'
    when 4
      if type_style == 'masonry'
        assign column_xxl = '3.69'
        assign column_xl = '3.69'
        assign column_lg = '3'
        assign column_md = '1.325'
        assign column_sm = '1.1'
      else 
        assign column_xxl = '4'
        assign column_xl = '4'
        assign column_lg = '4'
        assign column_md = '3'
        assign column_sm = '2'
      endif
    when 3
      if type_style == 'default'
        assign column_xxl = '3'
        assign column_xl = '3'
        assign column_lg = '2'
        assign column_md = '2'
        assign column_sm = '2'
      else 
        assign column_xxl = '3'
        assign column_xl = '3'
        assign column_lg = '3'
        assign column_md = '3'
        assign column_sm = '2'
      endif
  endcase
  assign column_xs = columns_mobile | default: 1
  if image_ratio == 'adapt'
    assign highest_ratio = 1
    for block in section.blocks
      if block.settings.collection != blank and block.settings.collection.featured_image and block.settings.collection.featured_image.aspect_ratio > highest_ratio
        assign highest_ratio = block.settings.collection.featured_image.aspect_ratio
      endif
    endfor
  endif
  capture icon_arrow_list
    render 'icon-arrow-list'
  endcapture

  if type_style == 'classic'
    assign heading_margin_bottom = heading_margin_bottom | divided_by: 10
  
    if settings.arrow_style == 'special'
      assign button_arrow_width = 6
      assign button_arrow_height = 6
      assign button_arrow_width_mb = 3.2
      assign button_arrow_height_mb = 3.2
    elsif settings.arrow_style == 'classic'
      assign button_arrow_width = 5
      assign button_arrow_height = 5
      assign button_arrow_width_mb = 4.8
      assign button_arrow_height_mb = 4.8
    elsif settings.arrow_style == 'modern'
      assign button_arrow_width = 9.3
      assign button_arrow_height = 6.5
      assign button_arrow_width_mb = 5.5
      assign button_arrow_height_mb = 5.5
    elsif settings.arrow_style == 'modern-plus'
      assign button_arrow_width = 11
      assign button_arrow_height = 6.5
      assign button_arrow_width_mb = 7.4
      assign button_arrow_height_mb = 4.5
    else
      assign button_arrow_width = 8
      assign button_arrow_height = 6
      assign button_arrow_width_mb = 7
      assign button_arrow_height_mb = 5
    endif
  
    assign carousel_controls_width = button_arrow_width | times: 2 | plus: 5.2
    assign carousel_controls_height = button_arrow_height | append: 'rem'
    assign carousel_controls_top = heading_margin_bottom | plus: carousel_controls_height | minus: 0.5
    assign carousel_controls_prev_right = button_arrow_width | plus: 2.7 | append: 'rem'
    assign header_margin_bottom = carousel_controls_height | plus: 0.5 | append: 'rem'
    assign header_padding-right = carousel_controls_width | plus: 10 | append: 'rem'

    assign carousel_controls_height_mb = button_arrow_height_mb
    assign carousel_controls_top_mb = heading_margin_bottom | plus: carousel_controls_height_mb
    assign carousel_controls_prev_right_mb = button_arrow_width_mb | plus: 2.7 | append: 'rem'
  endif
-%}

{%- if linklists[collection.handle] != blank -%}
{% assign menu = linklists[collection.handle] %}

<div class="section__c-list style--{{ type_style }}{% if arrows_type != 'none' or enable_carousel %}{% if type_style == 'masonry' %} display-arrow display-arrow__{{ arrows_type }}{% endif %}{% endif %}{% unless show_line_separator %} spacing spacing-xs{% endunless %} color-{{ color_scheme }} gradient"
  style="--padding-top: {{ padding_top }}px;
  --padding-bottom: {{ padding_bottom }}px;
  --padding-top-xs: {{ padding_top_mobile }}px;
  --padding-bottom-xs: {{ padding_bottom_mobile }}px;
  {%- if use_custom_color -%}
    --color-background: {{ colors_background.red }}, {{ colors_background.green }}, {{ colors_background.blue }};
    --gradient-background: {% if gradient_background != blank %}{{ gradient_background }}{% else %}{{ colors_background }}{% endif %};
  {%- endif -%}"
>
  <div class="page-width m-auto o-h{% if type_style == 'classic' %} collection-list--classic{% endif %}">
    {%- if show_line_separator -%}
      <div class="b-bottom spacing spacing-xs">
    {%- endif -%}
      {%- if heading != blank -%}
        <div class="p-w__header m-spacing{% if type_style == 'classic' and enable_carousel %} m-spacing-xs p-r p-r-xxl{% endif %}"
          style="{% if type_style == 'classic' %}--m-spacing-b: -{{ header_margin_bottom }};--m-spacing-b-xs: {{ heading_margin_bottom | times: 0.75 }}rem; --p-r: {{ carousel_controls_width }}rem;--p-r-xxl: {{ header_padding-right }};{% else %}--m-spacing-b: {{ heading_margin_bottom }}px;{% endif %}"
        >
          <div class="p-w__header--wrapper {{ header_alignment }}">
            <h2 id="SectionHeading-{{ section.id }}" class="p-w__heading m-0{% if settings.animations_reveal_on_scroll %} scroll-trigger animate--slide-in{% endif %}{% if use_custom_heading %} heading-section{% else %} {{ heading_size | prepend: 'heading-size-' }}{% endif %} {% if use_custom_heading_font %} custom-font{% endif %}" style="--heading-section-size: {{ custom_heading_size }}px; --heading-section-color: {{ custom_heading_color }};">
              {{ heading | escape }}
            </h2>
          </div>
        </div>
      {%- endif -%}
      <div class="p-w__content{% if type_style == 'classic' %} collection-list-content{% endif %}" style="--carousel-gap: {{ carousel_gap }}px;">
        <slider-component class="d-block pos-relative p-t p-t-xs{% if enable_carousel %} swiper-more-item{% if carousel_infinite_scroll %} infinite-scroll{% endif %}{% endif %}{% if settings.animations_reveal_on_scroll %} scroll-trigger animate--slide-in{% endif %}{% if type_style == 'classic' %} o-h{% endif %}"
          {% if enable_carousel %}
            {% if type_style == 'masonry' %}
              data-space-between="{{ carousel_gap }}" 
              data-space-between-tablet="{{ carousel_gap | times: 1.5 }}" 
              data-space-between-desktop="{{ carousel_gap | times: 2 }}" 
              data-item-xs="{% if columns_mobile == '1' %}1.055{% endif %}"
            {% else %}
              data-space-between-large="{{ carousel_gap_large }}"
              data-space-between="{{ carousel_gap }}" 
              data-item-xs="{{ column_xs }}"
            {% endif %}
            data-type-pagination="none"
            data-item-xxl="{{ column_xxl }}" 
            data-item-xl="{{ column_xl }}" 
            data-item-lg="{{ column_lg }}" 
            data-item-md="{{ column_md }}" 
            data-item-sm="{{ column_sm }}"
          {% endif %}
          {% if type_style == 'classic' %} style="--button-control-top: -{{ carousel_controls_top }}rem;--button-control-top-mb: -{{ carousel_controls_top_mb }}rem;--p-t: {{ carousel_controls_top }}rem;--p-t-xs: {{ carousel_controls_top_mb }}rem;"{% endif %}
        >
          <div class="swiperWrapper">
            {%- if enable_carousel -%}
              <div class="swiper d-block pos-relative no-js-overflow-x{% if type_style == 'masonry' %} grid-scroll{% endif %}{% if type_style != 'masonry' %} o-v{% endif %}">
            {%- endif -%}
              <div class="carousel__items d-flex{% if enable_carousel %} swiper-wrapper{% else %} f-wrap grid{% endif %}" 
                id="Slider-{{ section.id }}" 
                aria-label="Collection list" 
                style="--c-xs: {{ column_xs }}; --c-sm: {{ column_sm }}; --c-md: {{ column_md }}; --c-lg: {{ column_lg }}; --c-xl: {{ column_xl }}; --c-xxl: {{ column_xxl }};"
              >
                {% for link in menu.links %}
                  {%- liquid
                    assign total = forloop.index | modulo: 2
                    if total == 0
                        assign image_type = 'image-even'
                    else
                        assign image_type = 'image-odd'
                    endif
                  -%}
                  <div role="listitem" id="Slide-{{ section.id }}-{{ forloop.index }}" class="carousel__item{% if enable_carousel %} swiper-slide no-js-grid__item no-js-grid__scroll{% else %} grid__item{% endif %} {{ class_item }}">
                    <animate-element class="item d-block pos-relative color-foreground {{ settings.link_type | prepend: "link--style-" }}{% if type_style == 'masonry' %} u-none{% else %} u-u{% endif %}{% if settings.animations_reveal_on_scroll %} scroll-trigger animate--slide-in{% endif %}"
                      {% if settings.animations_reveal_on_scroll %}
                        data-cascade
                        style="--animation-order: {{ forloop.index }};"
                      {% endif %}
                    >
                      <{% if link.url != blank %}a{% else %}div{% endif %} 
                        class="item__media d-block m-w m-auto color-foreground link-cover {{ section.settings.text_alignment }} rounded o-h" 
                        {% if link.url != blank %}href="{{ link.url }}"{% endif %}
                        {% if link.url != blank and link.image and image_width == 'auto' %}
                          style="--m-w: {{ link.image.width | append: 'px' }};"
                        {% endif %}
                      >
                        <div class="media media--transparent media--{{ image_ratio }} media--zoom pos-relative o-h d-block {{ image_type }}" 
                          data-animate="{{ image_animation }}"
                          {% if image_ratio == 'adapt' %}
                            style="
                              {%- if type_style == 'masonry' -%}
                                {%- if image_type == 'image-even' -%}
                                  padding-bottom: {{ height_even_image }}%;
                                {%- else -%}
                                  padding-bottom: {{ height_odd_image }}%;
                                {%- endif -%}
                              {%- else -%}
                                padding-bottom: {{ 1 | divided_by: highest_ratio | times: 100 }}%;
                              {%- endif -%}
                              --a-delay: {{ '0.05' | times: forloop.index }}s;"
                          {% endif %}
                        >
                          {%- if link.url != blank and link.image -%}
                            {%- capture sizes -%}
                              (min-width: 990px) 550px, (min-width: 750px) 550px, calc(100vw - 30px)
                            {%- endcapture -%}
                            {{
                              link.image | image_url: width: 550 | image_tag:
                                loading: 'lazy',
                                sizes: sizes,
                                widths: '275, 550',
                                class: 'motion-reduce'
                            }}
                          {%- else -%}
                            {% capture index %}{% cycle 1, 2, 3, 4, 5, 6 %}{% endcapture %}
                            {{ 'collection-' | append: index | placeholder_svg_tag: 'placeholder-svg' }}
                          {%- endif -%}
                        </div>
                      </{% if link.url != blank %}a{% else %}div{% endif %}>
                      <div class="item__content {{ text_alignment }}">
                        <h3 class="d-inline-block pos-relative{% if blocks_heading_size == 'text-body' %} text-body{% else %} text-body {{ blocks_heading_size | prepend: 'heading-size-' }}{% endif %} {{ font_transform }} m-0 f-bold" data-animate="{{ text_animation }}" style="--a-delay: {{ '0.05' | times: forloop.index }}s;">
                          {%- if type_style == 'default' -%}
                            {{ link.title | default: 'Collection heading' }}
                          {%- else -%}
                            <span class="link-style">
                              {%- if type_style != 'masonry' -%}
                                <strong>
                              {%- endif -%}
                                {{ link.title | default: 'Collection heading' }}
                              {%- if type_style != 'masonry' -%}
                                </strong>
                              {%- endif -%}
                            </span>
                            {%- if link.title != blank and type_style != 'masonry' -%}
                              {% render 'icon-caret' %}
                            {%- endif -%}
                          {%- endif -%}
                        </h3>
                        {%- if type_style == 'default' -%}
                          {%- if link.description != blank -%}
                            <div class="item-content__desc text-size-x-small rte">
                                {{ link.description }}
                            </div>
                          {%- endif -%}
                          <div class="item-content__button">
                              <a href="{{ link.url }}"
                                  class="link u-link {{ settings.link_type | prepend: "link--style-" }}"
                                  aria-label="Shop Collection"
                              >
                                  <span class="text link-style">
                                    Shop Collection
                                  </span>
                              </a>
                          </div>
                        {%- endif -%}
                      </div>
                    </animate-element>
                  </div>
                {% endfor %}
              </div>
              {%- if menu.links.size > columns_desktop -%}
                <div class="carousel__controls arrow-style-{{ settings.arrow_style }}{% if type_style != 'default' %} carousel__controls--inner{% endif %}{% if arrows_type == 'none' or enable_carousel == false %} hidden{% endif %} no-js-hidden" style="--padding: 0px;{% if type_style == 'classic' %}--carousel_controls_width: {{ carousel_controls_width }}rem;--carousel_controls_height: {{ carousel_controls_height }};--carousel_controls_height_mb: {{ carousel_controls_height_mb }}rem;{% endif %}">
                  {% if enable_carousel and arrows_type != 'none' and settings.arrow_style == 'modern-plus' %}
                    <div class="arrow-wrap d-flex top-0 right-0 z-index-2 pos-absolute swiper-screen__{{ arrows_type }}">
                  {% endif %}
                    <button type="button" data-step="1" class="button-slider button-slider__prev{% if settings.arrow_style != 'modern-plus' %} swiper-screen__{{ arrows_type }}{% endif %} color-arrow t-button b-none c-pointer pos-absolute z-index-2 b-circle p-0 d-flex a-i-center j-c-center swiper-button-prev" aria-label="{{ 'accessibility.previous_slide' | t }}" aria-controls="Slider-{{ section.id }}" name="previous" 
                            style="{% if type_style == 'classic' %}--carousel_controls_prev_right: {{ carousel_controls_prev_right }};--carousel_controls_prev_right_mb: {{ carousel_controls_prev_right_mb }}{% endif %}">
                      {{ icon_arrow_list }}
                    </button>
                    <button type="button" data-step="1" class="button-slider button-slider__next{% if settings.arrow_style != 'modern-plus' %} swiper-screen__{{ arrows_type }}{% endif %} color-arrow t-button b-none c-pointer pos-absolute z-index-2 b-circle p-0 d-flex a-i-center j-c-center swiper-button-next" aria-label="{{ 'accessibility.next_slide' | t }}" aria-controls="Slider-{{ section.id }}" name="next">
                      {{ icon_arrow_list }}
                    </button>
                  {% if enable_carousel and arrows_type != 'none' and settings.arrow_style == 'modern-plus' %}
                      <div class="mask-overlay pos-absolute top-0 left-0"></div>
                    </div>
                  {% endif %}
                </div>
              {%- endif -%}
            {%- if enable_carousel -%}
              </div>
            {%- endif -%}
          </div>
        </slider-component>
      </div>
    {%- if show_line_separator -%}
      </div>
    {%- endif -%}
  </div>
</div>
{%- endif -%}
